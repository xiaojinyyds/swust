<!DOCTYPE html>
<html>

<head>
  <title>西南科技大学一站式网上服务大厅</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"><!--2 viewport-->
  <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no" /><!--3、x-ua-compatible-->
  <meta http-equiv="x-ua-compatible" content="IE=edge">
  <link type="text/css" rel="stylesheet" href="css/bootstrap.min.css" />
  <link rel="stylesheet" href="css/newIndex-v2.0.css">
  <script type="text/javascript" src="js/jquery.min.js"></script>
  <script type="text/javascript" src="js/security.js"></script>
  <script src="js/jquery.cookie.min.js"></script>
  <script src="js/bootstrap.js"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<style>
  div.banner {
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    height: 400px !important;
    width: 100% !important;
  }

  .carousel-control.left,
  .carousel-control.right {
    background-image: none !important;
  }

  .carousel-inner>.item {
    margin-top: 0px !important;
  }

  div.right div.wechat_box {
    padding: 10px 10px 10px 10px;
  }

  div.fridBox div.left {
    width: 40%;
    margin-top: 35px;
  }

  div.right {
    width: 60%;
    margin-top: 25px;
  }

  .tShow {
    display: block;
  }

  .tBlank {
    display: none;
  }

  .inputCodeBtn {
    border: 0px;
    outline: none;
    width: 90px;
    height: 38px;
    line-height: 38px;
    color: #fff;
    font-size: 14px;
    background-color: #5293FF;
  }
</style>

<body class="maxHeight">
  <div class="box">
    <header>
      <div class="logoBox fl">
        <a class="fl">
          <img src="./images/logoImg.png" alt=""></a>
        <p class="fl">一站式网上服务大厅</p>
      </div>
      <div class="textRight fr">
        <a class="fl logBtn" href="logout?service=http://soa.swust.edu.cn">登录</a>
        <span class="fl">|</span>
        <a class="fl use" href="logout?service=http://uap.swust.edu.cn/uap/a/cas">个人中心</a>
      </div>
    </header>
    <section>
      <div class="loginBox">
        <div id="myCarouse" class="carousel slide">
          <div class="carousel-inner">
            <div style='background-image: url("http://cas.swust.edu.cn/authserver/getUrl?type=1&sort=1");'
              class="item active banner">
            </div>
            <div style='background-image: url("http://cas.swust.edu.cn/authserver/getUrl?type=1&sort=2");'
              class="item banner">
            </div>
            <div style='background-image: url("http://cas.swust.edu.cn/authserver/getUrl?type=1&sort=3");'
              class="item banner">
            </div>
          </div>
          <!-- 轮播（Carousel）导航 --><a class="left carousel-control" href="#myCarouse" role="button" data-slide="prev">
            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="right carousel-control" href="#myCarouse" role="button" data-slide="next">
            <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
        </div>
        <div class="center">
          <div class="formCont lgBox">
            <div class="lgInfo fl">
              <div>
                ﻿<!-- <div class="box" id="login"> --><!--     <p class="loginTitle" th:utext="#{screen.welcome.instructions}"></p> -->
                <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
                <div id="passLogin">
                  <div class="top">
                    <h4>账号密码登录</h4>
                  </div>
                  <form method="post" id="fm1" autocomplete="off">
                    <ul class="formCont ">
                      <li>
                        <input type="hidden" name="execution" value="e1s1" /><input type="hidden" name="_eventId"
                          value="submit" /><input type="hidden" name="geolocation" /><input type="text"
                          placeholder="请输入工号/学号" class="inText required" id="username" accesskey="n" name="username"
                          value="" /><input type="hidden" name="lm" value="usernameLogin" />
                      </li>
                      <li>
                        <input type="password" name="password" placeholder="请输入登录密码" class="inText" size="25"
                          id="password" accesskey="p" value="" />
                      </li>
                      <li class="phoneLi">
                        <input type="text" name="captcha" placeholder="请输入图片验证码" class="inText fl phonIn" value=""><img
                          src="./images/captcha.jpg" id="imgCode" class="imgCode fl">
                      </li>
                      <li class="simLi">
                      </li>
                      <li class="passBox">
                        <div class="rePas fl">
                        </div>
                        <div class="forPas fr">
                          <a href="http://uap.swust.edu.cn/uap/a/sys/user/active">忘记密码？</a>
                        </div>
                      </li>
                      <li class="logBtn">
                        <button type="submit" name="submit" accesskey="l" class="inputBtn">登 &nbsp;&nbsp;录</button>
                      </li>
                      <li class="wechtLi">
                        <p class="fl">其他方式登录</p>
                        <a href="javascript:;" class="fl"
                          onclick="window.open('weChatLogin?requestUrl=' + weChatLogin())">
                          <img src="./images/weChat.png" alt=""></a>
                        <!--  	<a href="javascript:;" class="fl" onclick="switchTab('1')" style="margin-left: 5px" title="手机短信登录">
	   	  	    		<img src="./images/phoneLogin.png" alt="">
	   	  	    	</a> -->
                      </li>
                      <li>
                        <span id="capslock-on" style="display:none;">
                          <p>
                            <i class="fa fa-exclamation-circle"></i>
                            <span>CAPSLOCK key is turned on!</span>
                          </p>
                        </span>

                      </li>
                    </ul>
                    <script type="text/html" id="pwdError">
						</script>
                  </form>
                </div>
                <div id="phoneLogin" class="tBlank">
                  <div class="top">
                    <h4>短信登录</h4>
                  </div>
                  <form method="post" id="fm2" autocomplete="off">
                    <ul class="formCont ">
                      <li>
                        <input type="hidden" name="execution" value="e1s1" /><input type="hidden" name="_eventId"
                          value="submit" /><input type="hidden" name="geolocation" /><input type="text"
                          placeholder="请输入手机号" class="inText required" id="phone" accesskey="n" name="username"
                          value="" /><input type="hidden" name="lm" value="dynamicLogin" />
                      </li>
                      <li class="phoneLi">
                        <input type="text" name="dynamicCode" placeholder="请输入动态码" class="inText" value=""
                          id="dynamicCode" style="height: 38px;"><button type="button" id="getDynamic"
                          class="inputCodeBtn">获取动态码</button>
                      </li>
                      <li class="simLi">
                      </li>
                      <li class="passBox">
                        <div class="rePas fl">
                        </div>
                        <div class="forPas fr">
                          <a href="http://uap.swust.edu.cn/uap/a/sys/user/active">忘记密码？</a>
                        </div>
                      </li>
                      <li class="logBtn">
                        <button type="submit" name="submit" accesskey="l" class="inputBtn">登 &nbsp;&nbsp;录</button>
                      </li>
                      <li class="wechtLi">
                        <p class="fl">其他方式登录</p>
                        <a href="javascript:;" class="fl"
                          onclick="window.open('weChatLogin?requestUrl=' + weChatLogin())">
                          <img src="./images/weChat.png" alt=""></a>
                        <a href="javascript:;" class="fl" onclick="switchTab('2')" style="margin-left: 5px"
                          title="账号密码登录">
                          <img src="./images/pswLogin.png" alt=""></a>
                      </li>
                      <li>
                        <span id="capslock-on" style="display:none;">
                          <p>
                            <i class="fa fa-exclamation-circle"></i>
                            <span>CAPSLOCK key is turned on!</span>
                          </p>
                        </span>

                      </li>
                    </ul>
                    <script type="text/html" id="phoneError">
						</script>
                  </form>
                </div>

                <script type="text/javascript">
                  var i = "\u6B63\u5728\u767B\u5F55..."
                  $("#fm1").submit(function () {
                    $(":submit").attr("disabled", true);
                    $(":submit").attr("value", i);
                    return true;
                  });
                  //     $("#remCheck").on("click",function(){
                  //     	alert($(this).prev().prop("checked"));
                  //     })
                  function weChatLogin() {
                    var msg = window.location.href;
                    return msg;
                  }

                  function switchTab(value) {
                    if ("1" == value) {
                      $('#passLogin').addClass('tBlank');
                      $('#phoneLogin').removeClass('tBlank');
                    } else if ("2" == value) {
                      $('#phoneLogin').addClass('tBlank');
                      $('#passLogin').removeClass('tBlank');
                    }
                  }

                  //发送验证码
                  $("#getDynamic").click(function () {
                    var phoneTxt = $('#phone').val();
                    var reg = /^1[3|4|5|6|7|8|9][0-9]\d{8}$/
                    if (phoneTxt == '') {
                      $('#fm2 li.simLi').html('<p class="textError">手机账号不能为空</p>');
                    } else if (reg.test(phoneTxt)) {
                      //动态码
                      $.ajax({
                        url: "getDynamicCode",
                        type: "post",
                        async: false,
                        data: { mobile: phoneTxt },
                        success: function (data) {
                          if (data.success) {
                            time();
                            $('#fm2 li.simLi').html('<p class="textError">' + data.msg + '</p>');
                          } else {
                            $('#fm2 li.simLi').html('<p class="textError">' + data.msg + '</p>');
                          }
                        }
                      })
                    } else {
                      $('#fm2 li.simLi').html('<p class="textError">请输入正确的手机号</p>');
                    }
                  });

                  function time() {
                    $('#fm2 li.simLi').html('');
                    $('#getDynamic').attr('disabled', 'true');
                    $('#getDynamic').css({ 'cursor': 'not-allowed' })
                    let count = 60;
                    const countDown = setInterval(function () {
                      if (count === 0) {
                        $('#getDynamic').text('获取动态码').removeAttr('disabled');
                        $('#getDynamic').css({ 'cursor': 'pointer' })
                        clearInterval(countDown);
                      } else {
                        $('#getDynamic').text('重新发送' + '(' + count + ')');
                      }
                      count--;
                    }, 1000);
                  }

                  $(function () {
                    $(".imgCode").on("click", function () {
                      var timestamp = (new Date()).valueOf();
                      url = "captcha";
                      if ((url.indexOf("&") >= 0)) {
                        url = url + "×tamp=" + timestamp;
                      } else {
                        url = url + "?timestamp=" + timestamp;
                      }
                      $(this).attr("src", url);
                    });
                    var lm = "";
                    if (lm == "dynamicLogin") {
                      $('#passLogin').addClass('tBlank');
                      $('#phoneLogin').removeClass('tBlank');
                      $('#fm2 li.simLi').html($("#phoneError").html());
                    } else {
                      $('#phoneLogin').addClass('tBlank');
                      $('#passLogin').removeClass('tBlank');
                      $('#fm1 li.simLi').html($("#pwdError").html());
                    }
                  })
                </script>
                <!-- </div> -->
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="features">
        <div class="features-left">
          <div class="features-left-item">
            <h3>多平台融合</h3>
            <p>身份认证标识多样化<br />提供统一权限管理API接口</p>
          </div>
          <div class="features-left-item">
            <h3>统一登录</h3>
            <p>一个登录入口<br />一个网址，一个账号，一次登录</p>
          </div>
          <div class="features-left-item">
            <h3>流程引擎</h3>
            <p>一站式申请<br />审批、办结、办事流程便捷高效</p>
          </div>
          <div class="features-left-item">
            <h3>一站式服务</h3>
            <p>数据多跑路<br />师生少跑腿，一键式办理</p>
          </div>
        </div>
        <div class="features-right">
          <div class="l-line"></div>
          <div class="features-right-item">
            <a href="https://dmp.swust.edu.cn" target="_blank" class="weChat">
              <img src="./images/ask.png" alt="" class="wx_img">
              <p>扫码提问</p>
            </a>
            <h4>数据维护平台</h4>
          </div>
          <div class="features-right-item">
            <a href="javascript:;" class="weChat">
              <img src="./images/app_Ding.png" alt="" class="wx_img">
              <p>钉钉下载</p>
            </a>
            <h4>西南科大app新版</h4>
          </div>
          <div class="features-right-item">
            <a href=https://www.dingtalk.com/download?from=zebra:offline class="weChat">
              <img src="./images/pc_Ding.jpg" alt="" class="wx_img">
              <p>钉钉下载</p>
            </a>
            <h4>服务大厅PC端</h4>
          </div>
          <div class="features-right-item">
            <a href="http://cas.swust.edu.cn/JinGe.zip" class="weChat">
              <img src="./images/soft.png" alt="" class="wx_img">
              <p>金格软件</p>
            </a>
            <h4>下载及安装说明</h4>
          </div>
        </div>
      </div>
    </section>
  </div>
  <footer>
    <div class="about">
      <div class="fl">
        <a href="http://www.swust.edu.cn" target="_blank">西南科技大学主页</a>
        <a href="http://english.swust.edu.cn" target="_blank">English Version</a>
        <a href="http://news.swust.edu.cn" target="_blank">西南科技大学新闻网</a>
      </div>
      <p>Copyright © 2020 西南科技大学 网络与信息化处</p>
      <p class="fr">技术支持 0816-6089289</p>
    </div>
  </footer>
  <script>
    var i = "正在登录...";
    var Modulus, public_exponent;

    $(function () {
      $.getJSON("getKey", function (data) {
        Modulus = data["modulus"];
        public_exponent = data["exponent"];
      });

      var rem = $.cookie('remember');
      if (rem) {
        $("#myCheck").prop("checked", true);
        $("#username").val($.cookie("username"));
        $("#password").val($.cookie("password"));
      }
    });

    $("#fm1").submit(function () {
      $(":submit").attr("disabled", true);
      $(":submit").attr("value", i);
      if ($("#myCheck").prop("checked")) {
        var username = $("#username").val();
        var password = $("#password").val();
        $.cookie("remember", "true", { expires: 7 });
        $.cookie("username", username, { expires: 7 });
        $.cookie("password", password, { expires: 7 });
      } else {
        $.cookie("remember", "false", { expires: -1 });
        $.cookie("username", "", { expires: -1 });
        $.cookie("password", "", { expires: -1 });
      }
      var password = $("#password").val();
      var key = new RSAUtils.getKeyPair(public_exponent, "", Modulus);
      var reversedPwd = password.split("").reverse().join("");
      var encrypedPwd = RSAUtils.encryptedString(key, reversedPwd);
      $("#password").val(encrypedPwd);
      return true;
    });
    if (window.top !== window.self) { window.top.location = window.location };
    $(function () {
      $(".login").modal('show');
    });

    $('#myCarouse').carousel({ interval: 3000 });

    //防止页面后退
    history.pushState(null, null, document.URL);
    window.addEventListener('popstate', function () {
      history.pushState(null, null, document.URL);
    });
  </script>
</body>

</html>